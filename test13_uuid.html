<style>
  .image-container {
    display: flex;
    /* display: inline-block; */
    justify-content: space-between;
    width: 400px;
    /* border: 10px; */
    margin: 0 auto;
  }
  /* #image1 {
    border: 2px solid blue;
  } */
  .image-group {
    display: flex;
    /* display: inline-block; */
    justify-content: space-evenly;
    /* width: auto; */
    /* border: 10px; */
    flex-direction: column;
    align-items: center;
  }
  
  .image {
    width: 224px;
    /* height: 224px; */
    cursor: pointer;
    position: relative;
    margin: 10px 10px 10px 10px; 
    /* top right bottom left */
  }
</style>

<form id="myForm">
  <label for="gender">Gender:</label>
  <select id="gender" name="gender">
    <option value="male">Male</option>
    <option value="female">Female</option>
    <option value="other">Other</option>
  </select><br><br>
  <label for="age">Age:</label>
  <input type="number" id="age" name="age"><br><br>
  <label for="area">Area:</label>
  <input type="text" id="area" name="area"><br><br>
  <input type="hidden" id="uuid" name="uuid" value="">
  <input type="button" value="Submit" onclick="generateUUID(); test()">
</form>

<div id="practice-image-container" style="display: none;">
  <img id="pr_hu_img1" class='image' src="pr_hu_img1.jpeg">
  <img id="pr_hu_img2" class='image' src="pr_hu_img2.jpeg">
  <img id="pr_rb_img1" class='image' src="image_num_5.png">
  <img id="pr_rb_img2" class='image' src="image_num_3.png">
</div>

<div id="practice_success" style="display:none;"> 
  <button  onclick="window.toggle_instruction('rating_page');" > Continue! </button>
  
</div>

<button  onclick="keyboardevent();" > Do keyboard test! </button>

<button id="activate-btn">Activate Keyboard Listener</button>
<button id="destroy-btn">Destroy Keyboard Listener</button>


<div id="keyboardtest">
  <p id="k_text"></p>
</div>

<div id="imagegenerationtest"></div>
<script>
  function generateUUID() {
    var d = new Date().getTime();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r = (d + Math.random() * 16) % 16 | 0;
      d = Math.floor(d / 16);
      return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);
    });
    var uuidField = document.getElementById("uuid");
    uuidField.value = uuid;
    console.log(uuid);

    
    return uuid;
  }

  var images = [];
  // generate image names dynamically, but only once
  for (var i = 1; i <= 10; i++) {
    images.push("image_num_" + i + ".png");
  }

  function shuffleArray(array) {
					// Fisher-Yates shuffle algorithm
					for (let i = array.length - 1; i > 0; i--) {
						const j = Math.floor(Math.random() * (i + 1));
						[array[i], array[j]] = [array[j], array[i]];
					}
					return array;
      }

  function test() {

    const imageContainer = document.getElementById("imagegenerationtest");
    imageContainer.innerHTML = "";

    var shuffledImages = shuffleArray(images);

    
    for (var i = 0; i < shuffledImages.length/2; i++) {
        var img = document.createElement("img");
        img.src = shuffledImages[i];
        img.id = img.src.slice(6).slice(0, -4); // check id later
        img.width = 224;
        imageContainer.appendChild(img);
    }

    return shuffledImages;
  }

  let key_event_listeners;
  function keyboardevent() {
    key_event_listeners = document.addEventListener('keydown', (event) => {
    var name = event.key;
    var code = event.code;
    if (name === 'Control') {
      // Do nothing.
      return;
    }
    if (event.ctrlKey) {
      alert(`Combination of ctrlKey + ${name} \n Key code Value: ${code}`);
    } else {
      alert(`Key pressed ${name} \n Key code Value: ${code}`);
    }
  }, false);
  // Add event listener on keyup
  // document.addEventListener('keyup', (event) => {
  //   var name = event.key;
  //   if (name === 'Control') {
  //     alert('Control key released');
  //   }
  // }, false);
  }


  // // Add event listener on keydown, when q is pressed, modifty k_text element
  // document.addEventListener('keydown', (event) => {
  //   var name = event.key;
  //   var code = event.code;
  //   if (name === 'Control') {
  //     // Do nothing.
  //     return;
  //   }
  //   if (event.ctrlKey) {
  //     alert(`Combination of ctrlKey + ${name} \n Key code Value: ${code}`);
  //   } else {
  //     alert(`Key pressed ${name} \n Key code Value: ${code}`);
  //   }
  // }, false);

// get the buttons and the body element
const activateBtn = document.getElementById('activate-btn');
const destroyBtn = document.getElementById('destroy-btn');
const body = document.getElementsByTagName('body')[0];

// define the keyboard event listener function
function handleKeyPress(event) {
  console.log(`You pressed the ${event.key} key!`);
}

// define the event listener activation and destruction functions
function activateListener() {
  body.addEventListener('keydown', handleKeyPress);
  console.log('Keyboard event listener activated!');
}

function destroyListener() {
  body.removeEventListener('keydown', handleKeyPress);
  document.removeEventListener('keydown', key_event_listeners, false);
  console.log('Keyboard event listener destroyed!');
}

// add event listeners to the buttons
activateBtn.addEventListener('click', activateListener);
destroyBtn.addEventListener('click', destroyListener);


</script>